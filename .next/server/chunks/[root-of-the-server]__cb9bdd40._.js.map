{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/f.hacqueville/OneDrive%20-%20LYCEE%20LA%20PROVIDENCE%20NICOLAS%20BARRE/Code/docsLaPro/app/api/colorun/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport nodemailer from 'nodemailer'\r\nimport { writeFile, mkdir } from 'fs/promises'\r\nimport path from 'path'\r\nimport fs from 'fs'\r\n\r\nexport async function POST(req: Request) {\r\n    try {\r\n    const formData = await req.formData()\r\n    const photos = formData.getAll('photos') as File[]\r\n    const uploadDir = path.join(process.cwd(), 'uploads')\r\n    if (!fs.existsSync(uploadDir)) {\r\n      await mkdir(uploadDir, { recursive: true })\r\n    }\r\n    const attachments = []\r\n    for (const file of photos) {\r\n      const bytes = await file.arrayBuffer()\r\n      const buffer = Buffer.from(bytes)\r\n      const filePath = path.join(uploadDir, file.name)\r\n      await writeFile(filePath, buffer)\r\n      attachments.push({ filename: file.name, path: filePath })\r\n    }\r\n    const transporter = nodemailer.createTransport({\r\n  service: 'gmail',\r\n  auth: {\r\n    user: process.env.SMTP_USER,\r\n    pass: process.env.SMTP_PASS,\r\n  },\r\n})\r\n    await transporter.sendMail({\r\n      from: `\"Color-Run 2025\" <${process.env.SMTP_USER}>`,\r\n      to: 'florian@h-me.fr',\r\n      subject: `ðŸ“¸ Photos Color-Run`,\r\n      text: `Des photos ont Ã©tÃ© envoyÃ©es via le formulaire Color-Run.`,\r\n      attachments,\r\n    })\r\n    attachments.forEach((a) => fs.unlink(a.path, () => {}))\r\n    return NextResponse.json({ ok: true })\r\n  } catch (err) {\r\n    console.error('Erreur API Color-On:', err)\r\n    return NextResponse.json({ error: 'Erreur interne' }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEO,eAAe,KAAK,GAAY;IACnC,IAAI;QACJ,MAAM,WAAW,MAAM,IAAI,QAAQ;QACnC,MAAM,SAAS,SAAS,MAAM,CAAC;QAC/B,MAAM,YAAY,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;QAC3C,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,YAAY;YAC7B,MAAM,IAAA,8HAAK,EAAC,WAAW;gBAAE,WAAW;YAAK;QAC3C;QACA,MAAM,cAAc,EAAE;QACtB,KAAK,MAAM,QAAQ,OAAQ;YACzB,MAAM,QAAQ,MAAM,KAAK,WAAW;YACpC,MAAM,SAAS,OAAO,IAAI,CAAC;YAC3B,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,WAAW,KAAK,IAAI;YAC/C,MAAM,IAAA,kIAAS,EAAC,UAAU;YAC1B,YAAY,IAAI,CAAC;gBAAE,UAAU,KAAK,IAAI;gBAAE,MAAM;YAAS;QACzD;QACA,MAAM,cAAc,4JAAU,CAAC,eAAe,CAAC;YACjD,SAAS;YACT,MAAM;gBACJ,MAAM,QAAQ,GAAG,CAAC,SAAS;gBAC3B,MAAM,QAAQ,GAAG,CAAC,SAAS;YAC7B;QACF;QACI,MAAM,YAAY,QAAQ,CAAC;YACzB,MAAM,CAAC,kBAAkB,EAAE,QAAQ,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;YACnD,IAAI;YACJ,SAAS,CAAC,mBAAmB,CAAC;YAC9B,MAAM,CAAC,wDAAwD,CAAC;YAChE;QACF;QACA,YAAY,OAAO,CAAC,CAAC,IAAM,wGAAE,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,KAAO;QACpD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;QAAK;IACtC,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAiB,GAAG;YAAE,QAAQ;QAAI;IACtE;AACF","debugId":null}}]
}