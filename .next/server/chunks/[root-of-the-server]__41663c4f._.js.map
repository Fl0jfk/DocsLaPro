{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 127, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/f.hacqueville/OneDrive%20-%20LYCEE%20LA%20PROVIDENCE%20NICOLAS%20BARRE/Code/docsLaPro/app/api/upload-url/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { S3Client, PutObjectCommand } from '@aws-sdk/client-s3';\r\nimport { getAuth } from '@clerk/nextjs/server';\r\nimport { getSignedUrl } from '@aws-sdk/s3-request-presigner';\r\n\r\nconst s3 = new S3Client({ region: 'eu-west-3' });\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const { userId } = getAuth(req as any);\r\n    if (!userId) return NextResponse.json({ error: 'Non autorisé' }, { status: 401 });\r\n    const body = await req.json();\r\n    if (!body.filename || !body.contentType) {\r\n      return NextResponse.json({ error: 'filename et contentType requis' }, { status: 400 });\r\n    }\r\n    const key = `uploads-temp/${Date.now()}_${body.filename}`;\r\n    const command = new PutObjectCommand({\r\n      Bucket: process.env.BUCKET_NAME!,\r\n      Key: key,\r\n      ContentType: body.contentType,\r\n    });\r\n    const url = await getSignedUrl(s3, command, { expiresIn: 3600 });\r\n    return NextResponse.json({ url, key });\r\n  } catch (error) {\r\n    console.error('Erreur génération URL signée S3:', error);\r\n    return NextResponse.json({ error: String(error) }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AAAA;;;;;AAEA,MAAM,KAAK,IAAI,6JAAQ,CAAC;IAAE,QAAQ;AAAY;AAEvC,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,8DAA8D;QAC9D,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,wLAAO,EAAC;QAC3B,IAAI,CAAC,QAAQ,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;QAC/E,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,IAAI,CAAC,KAAK,QAAQ,IAAI,CAAC,KAAK,WAAW,EAAE;YACvC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiC,GAAG;gBAAE,QAAQ;YAAI;QACtF;QACA,MAAM,MAAM,CAAC,aAAa,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,QAAQ,EAAE;QACzD,MAAM,UAAU,IAAI,qKAAgB,CAAC;YACnC,QAAQ,QAAQ,GAAG,CAAC,WAAW;YAC/B,KAAK;YACL,aAAa,KAAK,WAAW;QAC/B;QACA,MAAM,MAAM,MAAM,IAAA,0MAAY,EAAC,IAAI,SAAS;YAAE,WAAW;QAAK;QAC9D,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;YAAK;QAAI;IACtC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oCAAoC;QAClD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,OAAO;QAAO,GAAG;YAAE,QAAQ;QAAI;IACnE;AACF","debugId":null}}]
}