{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/f.hacqueville/OneDrive%20-%20LYCEE%20LA%20PROVIDENCE%20NICOLAS%20BARRE/Code/docsLaPro/app/travels/%5Bid%5D/edit/form.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState, useRef, useCallback } from \"react\";\r\nimport { useUser } from \"@clerk/nextjs\";\r\n\r\ntype FileEntry = { filename: string; url: string };\r\n\r\ntype VoyageStatus = | \"draft\" | \"direction_validation\" | \"requests_stage\" | \"compta_validation\" | \"final_validation\" | \"validated\" | \"rejected\";\r\n\r\ntype Voyage = {\r\n  id: string;\r\n  lieu: string;\r\n  email:string;\r\n  activite: string;\r\n  date_depart: string;\r\n  date_retour: string;\r\n  classes: string;\r\n  effectif_eleves: number;\r\n  effectif_accompagnateurs: number;\r\n  commentaire: string;\r\n  pieces_jointes?: FileEntry[];\r\n  status: VoyageStatus;\r\n  direction_cible: string;\r\n  devis_requests?: any[];\r\n};\r\n\r\ntype FormValues = Omit<Voyage, \"id\" | \"pieces_jointes\" | \"status\" | \"devis_requests\">;\r\n\r\nconst statusLabels: Record<VoyageStatus, string> = {\r\n  draft: \"üìù Brouillon\",\r\n  direction_validation: \"üìã En validation direction\",\r\n  requests_stage: \"üöå Demandes de devis\",\r\n  compta_validation: \"üí∞ Validation compta\",\r\n  final_validation: \"‚úÖ Validation finale direction\",\r\n  validated: \"üéâ Voyage valid√©\",\r\n  rejected: \"‚ùå Rejet√©\",\r\n};\r\n\r\nexport default function VoyageEditForm({ voyageId }: { voyageId: string }) {\r\n  const { user, isLoaded } = useUser();\r\n  const [voyage, setVoyage] = useState<Voyage | null>(null);\r\n  const [formValues, setFormValues] = useState<FormValues | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n  const [newAttachments, setNewAttachments] = useState<File[]>([]);\r\n  const [initialAttachments, setInitialAttachments] = useState<FileEntry[]>([]);\r\n  const [isModified, setIsModified] = useState(false);\r\n  const fileInputRef = useRef<HTMLInputElement | null>(null);\r\n  useEffect(() => {\r\n    if (!isLoaded || !user) return;\r\n    const fetchVoyage = async () => {\r\n      setLoading(true);\r\n      setError(null);\r\n      try {\r\n        const res = await fetch(`/api/travels/get?voyageId=${voyageId}`);\r\n        if (!res.ok) throw new Error(\"Impossible de r√©cup√©rer le voyage\");\r\n        const data = await res.json();\r\n        setVoyage(data.voyage);\r\n        setFormValues({\r\n          lieu: data.voyage.lieu,\r\n          activite: data.voyage.activite,\r\n          date_depart: data.voyage.date_depart,\r\n          date_retour: data.voyage.date_retour,\r\n          email:data.voyage.email,\r\n          classes: data.voyage.classes,\r\n          effectif_eleves: data.voyage.effectif_eleves,\r\n          direction_cible: data.voyage.direction_cible,\r\n          effectif_accompagnateurs: data.voyage.effectif_accompagnateurs,\r\n          commentaire: data.voyage.commentaire || \"\",\r\n        });\r\n        setInitialAttachments(data.voyage.pieces_jointes || []);\r\n      } catch (err: any) {\r\n        setError(err.message);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchVoyage();\r\n  }, [voyageId, isLoaded]);\r\n\r\n  useEffect(() => {\r\n    if (!voyage || !formValues) return;\r\n    const unchanged =\r\n      formValues.lieu === voyage.lieu &&\r\n      formValues.activite === voyage.activite &&\r\n      formValues.date_depart === voyage.date_depart &&\r\n      formValues.date_retour === voyage.date_retour &&\r\n      formValues.classes === voyage.classes &&\r\n      formValues.effectif_eleves === voyage.effectif_eleves &&\r\n      formValues.effectif_accompagnateurs === voyage.effectif_accompagnateurs &&\r\n      formValues.commentaire === voyage.commentaire &&\r\n      newAttachments.length === 0;\r\n    setIsModified(!unchanged);\r\n  }, [formValues, voyage, newAttachments]);\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target;\r\n    setFormValues((prev) => (prev ? { ...prev, [name]: value } : prev));\r\n  };\r\n\r\n  const handleFilesChange = useCallback((files: File[]) => {\r\n    setNewAttachments((prev) => [...prev, ...files]);\r\n  }, []);\r\n\r\n  const uploadToS3 = async (file: File) => {\r\n    const res = await fetch(\"/api/travels/presign\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ voyageId, filename: file.name, type: file.type }),\r\n    });\r\n    const { uploadUrl, fileUrl } = await res.json();\r\n    await fetch(uploadUrl, { method: \"PUT\", body: file, headers: { \"Content-Type\": file.type } });\r\n    return { filename: file.name, url: fileUrl };\r\n  };\r\n\r\n  const removeAttachment = (index: number) => {\r\n    if (!voyage?.pieces_jointes) return;\r\n    const updated = [...voyage.pieces_jointes];\r\n    updated.splice(index, 1);\r\n    setVoyage({ ...voyage, pieces_jointes: updated });\r\n  };\r\n\r\n  const handleDragOver = (e: React.DragEvent<HTMLDivElement>) => e.preventDefault();\r\n  const handleDrop = (e: React.DragEvent<HTMLDivElement>) => {\r\n    e.preventDefault();\r\n    if (e.dataTransfer?.files) handleFilesChange(Array.from(e.dataTransfer.files));\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!formValues || !voyage || !isModified) return;\r\n    setSaving(true);\r\n    setError(null);\r\n    setSuccess(null);\r\n    try {\r\n      const uploaded = await Promise.all(newAttachments.map(uploadToS3));\r\n      const allAttachments = [...(voyage.pieces_jointes || []), ...uploaded];\r\n      const body = { ...voyage, ...formValues, pieces_jointes: allAttachments };\r\n      const res = await fetch(`/api/travels/update?voyageId=${voyageId}`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(body),\r\n      });\r\n      if (!res.ok) throw new Error(\"Erreur lors de la mise √† jour\");\r\n      setVoyage(body);\r\n      setInitialAttachments(allAttachments);\r\n      setNewAttachments([]);\r\n      setSuccess(\"Voyage mis √† jour ‚úÖ\");\r\n    } catch (err: any) {\r\n      setError(err.message);\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const updateStatus = async (newStatus: VoyageStatus) => {\r\n    try {\r\n      const res = await fetch(\"/api/travels/updateStatus\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ voyageId, newStatus }),\r\n      });\r\n      const data = await res.json();\r\n      if (!res.ok) throw new Error(data.error || \"Erreur de transition\");\r\n      setVoyage((prev) => (prev ? { ...prev, status: newStatus } : prev));\r\n      setSuccess(`Statut mis √† jour : ${statusLabels[newStatus]}`);\r\n    } catch (err: any) {\r\n      setError(err.message);\r\n    }\r\n  };\r\n\r\n  function getNextStatus(current: VoyageStatus): VoyageStatus {\r\n    const flow: VoyageStatus[] = [ \"draft\", \"direction_validation\", \"requests_stage\", \"compta_validation\", \"final_validation\", \"validated\",];\r\n    const i = flow.indexOf(current);\r\n    return i < flow.length - 1 ? flow[i + 1] : current;\r\n  }\r\n\r\n  function getPreviousStatus(current: VoyageStatus): VoyageStatus {\r\n    const flow: VoyageStatus[] = [ \"draft\", \"direction_validation\", \"requests_stage\", \"compta_validation\", \"final_validation\", \"validated\",];\r\n    const i = flow.indexOf(current);\r\n    return i > 0 ? flow[i - 1] : current;\r\n  }\r\n\r\n  if (!isLoaded) return <div>Chargement utilisateur‚Ä¶</div>;\r\n  if (!user) return <div>Veuillez vous connecter.</div>;\r\n  if (loading) return <div>Chargement du voyage‚Ä¶</div>;\r\n  if (!voyage || !formValues) return <div>Voyage introuvable.</div>;\r\n\r\n  function normalizeRoles(role: unknown): string[] {\r\n    if (Array.isArray(role)) return role as string[];\r\n    if (typeof role === \"string\") return [role];\r\n    return [];\r\n  }\r\n  const userRoles = normalizeRoles(user?.publicMetadata?.role);\r\n  const isCreator = voyage.email === user.primaryEmailAddress?.emailAddress;\r\n  const isDirectionCible = !!voyage.direction_cible && userRoles.includes(voyage.direction_cible);\r\n  const disabled = voyage.status !== \"draft\" && voyage.status !== \"direction_validation\" && !isCreator;\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"pt-[15vh] flex flex-col gap-4 max-w-xl mx-auto\">\r\n      <h2 className=\"text-xl font-bold mb-2\">Modifier le voyage</h2>\r\n\r\n      <div className=\"text-sm bg-gray-100 px-3 py-2 rounded border\">\r\n        <strong>Statut :</strong> {statusLabels[voyage.status]}\r\n      </div>\r\n      {error && <div className=\"text-red-600\">{error}</div>}\r\n      {success && <div className=\"text-green-600\">{success}</div>}\r\n\r\n      <label>\r\n        Lieu :\r\n        <input name=\"lieu\" value={formValues.lieu} onChange={handleChange} required disabled={disabled} />\r\n      </label>\r\n      <label>\r\n        Activit√© :\r\n        <input name=\"activite\" value={formValues.activite} onChange={handleChange} required disabled={disabled} />\r\n      </label>\r\n      <label>\r\n        Date de d√©part :\r\n        <input type=\"date\" name=\"date_depart\" value={formValues.date_depart} onChange={handleChange} required disabled={disabled} />\r\n      </label>\r\n      <label>\r\n        Date de retour :\r\n        <input type=\"date\" name=\"date_retour\" value={formValues.date_retour} onChange={handleChange} required disabled={disabled} />\r\n      </label>\r\n      <label>\r\n        Classes :\r\n        <input name=\"classes\" value={formValues.classes} onChange={handleChange} required disabled={disabled} />\r\n      </label>\r\n      <label>\r\n        Nombre d‚Äô√©l√®ves :\r\n        <input type=\"number\" name=\"effectif_eleves\" min={1} value={formValues.effectif_eleves} onChange={handleChange} required disabled={disabled} />\r\n      </label>\r\n      <label>\r\n        Nombre d‚Äôaccompagnateurs :\r\n        <input type=\"number\" name=\"effectif_accompagnateurs\" min={1} value={formValues.effectif_accompagnateurs} onChange={handleChange} required disabled={disabled} />\r\n      </label>\r\n\r\n      <div>\r\n        <strong>Pi√®ces jointes :</strong>\r\n        {voyage.pieces_jointes?.length ? (\r\n          <ul>\r\n            {voyage.pieces_jointes.map((f, i) => (\r\n              <li key={i}>\r\n                <a href={f.url} target=\"_blank\">{f.filename}</a>\r\n                {!disabled && (\r\n                  <button type=\"button\" onClick={() => removeAttachment(i)} className=\"ml-2 text-red-600\">Supprimer</button>\r\n                )}\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        ) : (\r\n          <span>Aucune pi√®ce jointe</span>\r\n        )}\r\n      </div>\r\n\r\n      {!disabled && (\r\n        <div\r\n          onDragOver={handleDragOver}\r\n          onDrop={handleDrop}\r\n          onClick={() => fileInputRef.current?.click()}\r\n          className=\"border-2 border-dashed border-gray-400 rounded p-4 text-center text-gray-500 cursor-pointer hover:bg-gray-50\"\r\n        >\r\n          {newAttachments.length\r\n            ? `${newAttachments.length} fichier(s) ajout√©(s)`\r\n            : \"Glissez vos fichiers ici ou cliquez pour s√©lectionner\"}\r\n          <input\r\n            ref={fileInputRef}\r\n            type=\"file\"\r\n            multiple\r\n            accept=\".pdf,.doc,.docx,image/*\"\r\n            className=\"hidden\"\r\n            onChange={(e) => e.target.files && handleFilesChange(Array.from(e.target.files))}\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      <label>\r\n        Commentaire :\r\n        <textarea name=\"commentaire\" value={formValues.commentaire} onChange={handleChange} disabled={disabled} />\r\n      </label>\r\n\r\n      {!disabled && (\r\n        <button type=\"submit\" disabled={!isModified || saving} className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-400\">\r\n          {saving ? \"Enregistrement‚Ä¶\" : \"Mettre √† jour\"}\r\n        </button>\r\n      )}\r\n\r\n      {/* --- Mini-formulaire de demande de devis --- */}\r\n      {isCreator && voyage.status === \"requests_stage\" && (\r\n  <div className=\"mt-4 border-t pt-4\">\r\n    <h3 className=\"font-bold mb-2\">Demande de devis</h3>\r\n    <DevisRequestForm voyage={voyage} setVoyage={setVoyage} />\r\n  </div>\r\n)}\r\n      {isDirectionCible && (\r\n        <div className=\"mt-6 border-t pt-4\">\r\n          <h3 className=\"font-bold mb-2\">Contr√¥le de validation (Direction)</h3>\r\n          <div className=\"flex gap-2\">\r\n            <button type=\"button\" onClick={() => updateStatus(getPreviousStatus(voyage.status))} className=\"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700\"> ‚Üê √âtape pr√©c√©dente</button>\r\n            <button type=\"button\" onClick={() => updateStatus(getNextStatus(voyage.status))} className=\"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700\">√âtape suivante ‚Üí</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </form>\r\n  );\r\n}\r\n\r\nfunction DevisRequestForm({\r\n  voyage,\r\n  setVoyage,\r\n}: {\r\n  voyage: Voyage;\r\n  setVoyage: React.Dispatch<React.SetStateAction<Voyage | null>>;\r\n}) {\r\n  const [loading, setLoading] = useState(false);\r\n  const [msg, setMsg] = useState(\"\");\r\n  const [heureDepart, setHeureDepart] = useState(\"\");\r\n  const [carSurPlace, setCarSurPlace] = useState(false);\r\n  const [commentaire, setCommentaire] = useState(\"\");\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setMsg(\"\");\r\n    try {\r\n      const infos = { heureDepart, carSurPlace, commentaire };\r\n      const res = await fetch(\"/api/travels/devis/request\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ voyageId: voyage.id, infos }),\r\n      });\r\n      const data = await res.json();\r\n      if (!res.ok) throw new Error(data.error || \"Erreur lors de la demande de devis\");\r\n      setVoyage((prev) =>\r\n        prev\r\n          ? {\r\n              ...prev,\r\n              devis_requests: [\r\n                ...(prev.devis_requests || []),\r\n                { infos, date: new Date().toISOString(), status: \"pending\" },\r\n              ],\r\n            }\r\n          : prev\r\n      );\r\n      setMsg(\"Demande de devis envoy√©e √† tous les transporteurs ‚úÖ\");\r\n      setHeureDepart(\"\");\r\n      setCarSurPlace(false);\r\n      setCommentaire(\"\");\r\n    } catch (err: any) {\r\n      setMsg(err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"flex flex-col gap-2\">\r\n      <label>\r\n        Heure de d√©part :\r\n        <input type=\"time\" value={heureDepart} onChange={(e) => setHeureDepart(e.target.value)} required />\r\n      </label>\r\n      <label>\r\n        Besoin d‚Äôun car sur place :\r\n        <input type=\"checkbox\" checked={carSurPlace} onChange={(e) => setCarSurPlace(e.target.checked)} />\r\n      </label>\r\n      <label>\r\n        Commentaire (optionnel) :\r\n        <textarea value={commentaire} onChange={(e) => setCommentaire(e.target.value)} />\r\n      </label>\r\n      <button type=\"button\" onClick={handleSubmit} disabled={loading} className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\">\r\n        {loading ? \"Envoi‚Ä¶\" : \"Envoyer la demande de devis\"}\r\n      </button>\r\n      {msg && <div className={`mt-2 ${msg.includes(\"‚úÖ\") ? \"text-green-600\" : \"text-red-600\"}`}>{msg}</div>}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}