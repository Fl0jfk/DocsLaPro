{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/f.hacqueville/OneDrive%20-%20LYCEE%20LA%20PROVIDENCE%20NICOLAS%20BARRE/Code/docsLaPro/app/api/ecoledirecte/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\n// @ts-ignore\r\nimport { Session } from \"api-ecoledirecte\";\r\n\r\nexport const runtime = \"node\"; // ⚠ obligatoire pour utiliser node-fetch\r\n(global as any).fetch = fetch;\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    const { identifiant, motdepasse } = await req.json();\r\n\r\n    if (!identifiant || !motdepasse) {\r\n      return NextResponse.json(\r\n        { error: \"Identifiant et mot de passe requis\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const session = new Session();\r\n\r\n    try {\r\n      await session.login(identifiant, motdepasse);\r\n    } catch (loginErr) {\r\n      return NextResponse.json(\r\n        { error: \"Impossible de se connecter\", details: loginErr },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const notes = await session.accounts[0]?.fetchNotes();\r\n    const messages = await session.accounts[0]?.fetchMessages();\r\n    const emploiDuTemps = await session.accounts[0]?.fetchEmploiDuTemps();\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      notes: notes ?? [],\r\n      messages: messages ?? [],\r\n      emploiDuTemps: emploiDuTemps ?? [],\r\n    });\r\n  } catch (err) {\r\n    console.error(\"Erreur API EcoleDirecte :\", err);\r\n    return NextResponse.json({ error: \"Erreur lors de la requête\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA,aAAa;AACb;;;AAEO,MAAM,UAAU,QAAQ,yCAAyC;AACxE,yDAAgB,KAAK,GAAG;AAEjB,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,EAAE,WAAW,EAAE,UAAU,EAAE,GAAG,MAAM,IAAI,IAAI;QAElD,IAAI,CAAC,eAAe,CAAC,YAAY;YAC/B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAqC,GAC9C;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,UAAU,IAAI,yJAAO;QAE3B,IAAI;YACF,MAAM,QAAQ,KAAK,CAAC,aAAa;QACnC,EAAE,OAAO,UAAU;YACjB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;gBAA8B,SAAS;YAAS,GACzD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,QAAQ,MAAM,QAAQ,QAAQ,CAAC,EAAE,EAAE;QACzC,MAAM,WAAW,MAAM,QAAQ,QAAQ,CAAC,EAAE,EAAE;QAC5C,MAAM,gBAAgB,MAAM,QAAQ,QAAQ,CAAC,EAAE,EAAE;QAEjD,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO,SAAS,EAAE;YAClB,UAAU,YAAY,EAAE;YACxB,eAAe,iBAAiB,EAAE;QACpC;IACF,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACF","debugId":null}}]
}