{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 109, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/f.hacqueville/OneDrive%20-%20LYCEE%20LA%20PROVIDENCE%20NICOLAS%20BARRE/Code/docsLaPro/app/api/documents/get-url/route.ts"],"sourcesContent":["import { NextRequest } from \"next/server\";\r\nimport { S3Client, GetObjectCommand } from \"@aws-sdk/client-s3\";\r\nimport { getSignedUrl } from \"@aws-sdk/s3-request-presigner\";\r\n\r\nconst s3 = new S3Client({\r\n  region: process.env.REGION!,\r\n  credentials: { accessKeyId: process.env.ACCESS_KEY_ID!, secretAccessKey: process.env.SECRET_ACCESS_KEY!},\r\n});\r\n\r\nexport async function GET(req: NextRequest) {\r\n  const { searchParams } = new URL(req.url);\r\n  const key = searchParams.get(\"key\");\r\n  if (!key) { return new Response(JSON.stringify({ error: \"Cl√© du document absente\" }), { status: 400 });}\r\n  try {\r\n    const expiresInSeconds = 60 * 60;\r\n    const command = new GetObjectCommand({ Bucket: process.env.BUCKET_NAME!, Key: key});\r\n    const url = await getSignedUrl(s3, command, { expiresIn: expiresInSeconds });\r\n    return new Response(JSON.stringify({ url }), { status: 200 });\r\n  } catch (error) {\r\n    return new Response(JSON.stringify({ error: String(error) }), { status: 500 });\r\n  }\r\n}"],"names":[],"mappings":";;;;AACA;AACA;AAAA;;;AAEA,MAAM,KAAK,IAAI,6JAAQ,CAAC;IACtB,QAAQ,QAAQ,GAAG,CAAC,MAAM;IAC1B,aAAa;QAAE,aAAa,QAAQ,GAAG,CAAC,aAAa;QAAG,iBAAiB,QAAQ,GAAG,CAAC,iBAAiB;IAAC;AACzG;AAEO,eAAe,IAAI,GAAgB;IACxC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;IACxC,MAAM,MAAM,aAAa,GAAG,CAAC;IAC7B,IAAI,CAAC,KAAK;QAAE,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE,OAAO;QAA0B,IAAI;YAAE,QAAQ;QAAI;IAAG;IACvG,IAAI;QACF,MAAM,mBAAmB,KAAK;QAC9B,MAAM,UAAU,IAAI,qKAAgB,CAAC;YAAE,QAAQ,QAAQ,GAAG,CAAC,WAAW;YAAG,KAAK;QAAG;QACjF,MAAM,MAAM,MAAM,IAAA,0MAAY,EAAC,IAAI,SAAS;YAAE,WAAW;QAAiB;QAC1E,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE;QAAI,IAAI;YAAE,QAAQ;QAAI;IAC7D,EAAE,OAAO,OAAO;QACd,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE,OAAO,OAAO;QAAO,IAAI;YAAE,QAAQ;QAAI;IAC9E;AACF","debugId":null}}]
}