{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/f.hacqueville/OneDrive%20-%20LYCEE%20LA%20PROVIDENCE%20NICOLAS%20BARRE/Code/docsLaPro/app/prof-room/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useUser } from \"@clerk/nextjs\";\r\n\r\nconst FRENCH_HOLIDAYS_2025 = [\r\n  \"2025-01-01\",\r\n  \"2025-04-21\",\r\n  \"2025-05-01\",\r\n  \"2025-05-08\",\r\n  \"2025-05-29\",\r\n  \"2025-06-09\",\r\n  \"2025-07-14\",\r\n  \"2025-08-15\",\r\n  \"2025-11-01\",\r\n  \"2025-11-11\",\r\n  \"2025-12-25\",\r\n];\r\n\r\nfunction isWeekend(date: Date) {\r\n  const d = date.getDay();\r\n  return d === 0 || d === 6;\r\n}\r\n\r\nexport default function ProfRoomPage() {\r\n  const { user, isLoaded } = useUser();\r\n  const [rooms, setRooms] = useState<any[]>([]);\r\n  const [reservations, setReservations] = useState<any[]>([]);\r\n  const [form, setForm] = useState({ roomId: \"\", date: \"\", hour: \"08:00\" });\r\n\r\n  useEffect(() => {\r\n    async function load() {\r\n      const roomsRes = await fetch(\"/api/reservation-rooms/rooms\");\r\n      const { rooms } = await roomsRes.json();\r\n      setRooms(rooms);\r\n\r\n      const resRes = await fetch(\"/api/reservation-rooms/reservations\");\r\n      const { reservations } = await resRes.json();\r\n      setReservations(reservations);\r\n    }\r\n    load();\r\n  }, []);\r\n\r\n  async function handleSubmit(e: any) {\r\n    e.preventDefault();\r\n    const { roomId, date, hour } = form;\r\n    const start = new Date(`${date}T${hour}:00`);\r\n\r\n    if (isWeekend(start) || FRENCH_HOLIDAYS_2025.includes(date)) {\r\n      alert(\"⛔️ Impossible de réserver un week-end ou jour férié.\");\r\n      return;\r\n    }\r\n\r\n    const end = new Date(start.getTime() + 60 * 60 * 1000);\r\n    const res = await fetch(\"/api/reservation-rooms/reservations/create\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ roomId, startsAt: start, endsAt: end }),\r\n    });\r\n\r\n    if (res.ok) {\r\n      alert(\"✅ Demande envoyée !\");\r\n      setForm({ roomId: \"\", date: \"\", hour: \"08:00\" });\r\n    } else {\r\n      const err = await res.json();\r\n      alert(\"Erreur : \" + (err.error || \"inconnue\"));\r\n    }\r\n  }\r\n\r\n  if (!isLoaded) return <p>Chargement...</p>;\r\n  if (!user) return <p>Veuillez vous connecter</p>;\r\n\r\n  return (\r\n    <div className=\"p-8 max-w-lg mx-auto\">\r\n      <h1 className=\"text-2xl font-bold mb-6\">Réserver une salle</h1>\r\n\r\n      <form onSubmit={handleSubmit} className=\"space-y-4 border p-4 rounded bg-gray-50\">\r\n        <div>\r\n          <label className=\"block mb-1 font-medium\">Salle</label>\r\n          <select\r\n            value={form.roomId}\r\n            onChange={(e) => setForm({ ...form, roomId: e.target.value })}\r\n            className=\"border rounded w-full p-2\"\r\n            required\r\n          >\r\n            <option value=\"\">-- Choisir une salle --</option>\r\n            {rooms.map((r) => (\r\n              <option key={r.id} value={r.id}>{r.name}</option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block mb-1 font-medium\">Date</label>\r\n          <input\r\n            type=\"date\"\r\n            value={form.date}\r\n            onChange={(e) => setForm({ ...form, date: e.target.value })}\r\n            className=\"border rounded w-full p-2\"\r\n            required\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block mb-1 font-medium\">Heure de début</label>\r\n          <input\r\n            type=\"time\"\r\n            value={form.hour}\r\n            onChange={(e) => setForm({ ...form, hour: e.target.value })}\r\n            className=\"border rounded w-full p-2\"\r\n            required\r\n          />\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"\r\n        >\r\n          Envoyer la demande\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}